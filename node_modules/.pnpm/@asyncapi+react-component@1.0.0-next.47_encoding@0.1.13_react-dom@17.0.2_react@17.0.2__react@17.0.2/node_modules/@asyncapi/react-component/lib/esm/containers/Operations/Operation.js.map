{"version":3,"file":"Operation.js","sourceRoot":"","sources":["../../../../src/containers/Operations/Operation.tsx"],"names":[],"mappings":"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","sourcesContent":["import React from 'react';\nimport { Channel, Operation as OperationType } from '@asyncapi/parser';\n\nimport { Message } from '../Messages/Message';\nimport { Security } from '../Servers/Security';\nimport {\n  Href,\n  Markdown,\n  Schema,\n  Bindings,\n  Tags,\n  Extensions,\n} from '../../components';\n\nimport { useConfig } from '../../contexts';\nimport { CommonHelpers, SchemaHelpers } from '../../helpers';\nimport {\n  EXTERAL_DOCUMENTATION_TEXT,\n  PUBLISH_LABEL_DEFAULT_TEXT,\n  SUBSCRIBE_LABEL_DEFAULT_TEXT,\n} from '../../constants';\nimport { PayloadType } from '../../types';\n\ninterface Props {\n  type: PayloadType;\n  operation: OperationType;\n  channelName: string;\n  channel: Channel;\n}\n\nexport const Operation: React.FunctionComponent<Props> = props => {\n  const config = useConfig();\n  const { type = PayloadType.PUBLISH, operation, channelName, channel } = props;\n\n  if (!operation || !channel) {\n    return null;\n  }\n\n  // check typeof as fallback for older version than `2.2.0`\n  const servers = typeof channel.servers === 'function' && channel.servers();\n  // check typeof as fallback for older version than `2.4.0`\n  const security =\n    typeof operation.security === 'function' && operation.security();\n  const parameters = SchemaHelpers.parametersToSchema(channel.parameters());\n\n  return (\n    <div>\n      <div className=\"panel-item--center px-8\">\n        <OperationInfo {...props} />\n\n        {servers && servers.length > 0 ? (\n          <div className=\"mt-2 text-sm\">\n            <p>Available only on servers:</p>\n            <ul className=\"flex flex-wrap leading-normal\">\n              {servers.map(server => (\n                <li className=\"inline-block mt-2 mr-2\" key={server as string}>\n                  <a\n                    href={`#${CommonHelpers.getIdentifier(\n                      'server-' + server,\n                      config,\n                    )}`}\n                    className=\"border border-solid border-blue-300 hover:bg-blue-300 hover:text-blue-600 text-blue-500 font-bold no-underline text-xs rounded px-3 py-1 cursor-pointer\"\n                  >\n                    <span className=\"underline\">{server}</span>\n                  </a>\n                </li>\n              ))}\n            </ul>\n          </div>\n        ) : null}\n\n        {parameters && (\n          <div\n            className=\"mt-2\"\n            id={CommonHelpers.getIdentifier(\n              `operation-${type}-${channelName}-parameters`,\n              config,\n            )}\n          >\n            <Schema\n              schemaName=\"Parameters\"\n              schema={parameters}\n              expanded={true}\n            />\n          </div>\n        )}\n\n        {security && (\n          <div\n            className=\"mt-2\"\n            id={CommonHelpers.getIdentifier(\n              `operation-${type}-${channelName}-security`,\n              config,\n            )}\n          >\n            <Security\n              security={security}\n              header=\"Additional security requirements\"\n            />\n          </div>\n        )}\n\n        {channel.hasBindings() && (\n          <div className=\"mt-2\">\n            <Bindings\n              name=\"Channel specific information\"\n              bindings={channel.bindings()}\n            />\n          </div>\n        )}\n\n        <Extensions name=\"Channel Extensions\" item={channel} />\n\n        {operation.hasBindings() && (\n          <div className=\"mt-2\">\n            <Bindings\n              name=\"Operation specific information\"\n              bindings={operation.bindings()}\n            />\n          </div>\n        )}\n\n        <Extensions name=\"Operation Extensions\" item={operation} />\n\n        {operation.hasTags() && (\n          <div className=\"mt-2\">\n            <Tags tags={operation.tags()} />\n          </div>\n        )}\n      </div>\n\n      <div\n        className=\"w-full mt-4\"\n        id={CommonHelpers.getIdentifier(\n          `operation-${type}-${channelName}-message`,\n          config,\n        )}\n      >\n        {operation.hasMultipleMessages() ? (\n          <div className=\"mt-2\">\n            <p className=\"px-8\">\n              Accepts <strong>one of</strong> the following messages:\n            </p>\n            <ul>\n              {operation.messages().map((msg, idx) => (\n                <li className=\"mt-4\" key={idx}>\n                  <Message message={msg} index={idx} showExamples={true} />\n                </li>\n              ))}\n            </ul>\n          </div>\n        ) : (\n          <div className=\"mt-2\">\n            <p className=\"px-8\">Accepts the following message:</p>\n            <div className=\"mt-2\">\n              <Message\n                message={(operation.message as (index: number) => any)(0)}\n                showExamples={true}\n              />\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport const OperationInfo: React.FunctionComponent<Props> = ({\n  type = PayloadType.PUBLISH,\n  operation,\n  channelName,\n  channel,\n}) => {\n  const config = useConfig();\n  const operationSummary = operation.summary();\n  const externalDocs = operation.externalDocs();\n  const operationId = operation.id();\n\n  return (\n    <>\n      <div className=\"mb-4\">\n        <h3>\n          <span\n            className={`font-mono border uppercase p-1 rounded mr-2 ${\n              type === PayloadType.PUBLISH\n                ? 'border-blue-600 text-blue-500'\n                : 'border-green-600 text-green-600'\n            }`}\n            title={type}\n          >\n            {type === PayloadType.PUBLISH\n              ? config.publishLabel || PUBLISH_LABEL_DEFAULT_TEXT\n              : config.subscribeLabel || SUBSCRIBE_LABEL_DEFAULT_TEXT}\n          </span>{' '}\n          <span className=\"font-mono text-base\">{channelName}</span>\n        </h3>\n      </div>\n\n      {channel.hasDescription() && (\n        <div className=\"mt-2\">\n          <Markdown>{channel.description()}</Markdown>\n        </div>\n      )}\n      {operationSummary && (\n        <p className=\"text-gray-600 text-sm mt-2\">{operationSummary}</p>\n      )}\n      {operation.hasDescription() && (\n        <div className=\"mt-2\">\n          <Markdown>{operation.description()}</Markdown>\n        </div>\n      )}\n\n      {externalDocs && (\n        <ul className=\"leading-normal mt-2 mb-4 space-x-2 space-y-2\">\n          {externalDocs && (\n            <li className=\"inline-block\">\n              <Href\n                className=\"border border-solid border-orange-300 hover:bg-orange-300 hover:text-orange-600 text-orange-500 font-bold no-underline text-xs uppercase rounded px-3 py-1\"\n                href={externalDocs.url()}\n              >\n                <span>{EXTERAL_DOCUMENTATION_TEXT}</span>\n              </Href>\n            </li>\n          )}\n        </ul>\n      )}\n\n      {operationId && (\n        <div className=\"border bg-gray-100 rounded px-4 py-2 mt-2\">\n          <div className=\"text-sm text-gray-700\">\n            Operation ID\n            <span className=\"border text-orange-600 rounded text-xs ml-2 py-0 px-2\">\n              {operationId}\n            </span>\n          </div>\n        </div>\n      )}\n    </>\n  );\n};\n"]}